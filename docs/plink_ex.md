# Association

<http://zzz.bwh.harvard.edu/plink/anal.shtml>

```
$ plink --bfile mydata --assoc --allow-no-sex
$ less plink.assoc

 CHR  SNP         BP   A1      F_A      F_U   A2        CHISQ            P           OR
   1   N0          0    a 0.009375  0.01125    A       0.2756       0.5996       0.8318
   1   N1          1    a   0.1406   0.1206    A        2.818      0.09322        1.193
   1   N2          2    a   0.3575   0.3712    A        0.653        0.419       0.9424
   1   N3          3    a   0.4494     0.44    A       0.2847       0.5936        1.039
   1   N4          4    a   0.1725   0.1819    A       0.4823       0.4874       0.9377
   1   N5          5    a    0.385   0.4062    A        1.511        0.219       0.9149
   1   N6          6    a   0.2494   0.2531    A       0.0598       0.8068       0.9803
   1   N7          7    a   0.3625   0.3662    A      0.04857       0.8256       0.9839
   1   N8          8    a   0.1712   0.1756    A       0.1068       0.7438       0.9699
   1   N9          9    a   0.3644   0.3975    A        3.722      0.05369       0.8689
   1  N10         10    a  0.01375  0.01438    A      0.02254       0.8807       0.9559
   1  N11         11    a   0.4431   0.4169    A        2.249       0.1337        1.113
   1  N12         12    a   0.2419   0.2362    A       0.1391       0.7091        1.031
   1  N13         13    a  0.03562  0.04062    A       0.5454       0.4602       0.8724
   1  N14         14    a  0.08688  0.09125    A       0.1887        0.664       0.9475
   1  N15         15    a    0.335   0.3312    A      0.05064        0.822        1.017
   1  N16         16    a   0.2131   0.2125    A     0.001865       0.9655        1.004
   1  N17         17    a   0.3812   0.3975    A       0.8885       0.3459       0.9339
   1   P1         18    a   0.2106   0.1956    A        1.112       0.2916        1.097
   1   P2         19    a   0.2012   0.2031    A      0.01744       0.8949       0.9884
```


# LD calculation

<http://zzz.bwh.harvard.edu/plink/ld.shtml>

```
$ plink --bfile mydata --allow-no-sex --r2 inter-chr --ld-window-r2 0.005
$ less plink.ld

 CHR_A         BP_A SNP_A  CHR_B         BP_B SNP_B           R2
     1            6   N5      1           20   P2   0.00615137
     1           19   P1      1           20   P2     0.017151
```

```
$ plink --bfile mydata --allow-no-sex --r2 dprime inter-chr --ld-window-r2 0
$ less plink.ld

 CHR_A         BP_A SNP_A  CHR_B         BP_B SNP_B           R2           DP
     1            0   N0      1            1   N1  0.000464463    0.0818375
     1            0   N0      1            2   N2  8.99385e-05     0.122706
     1            0   N0      1            3   N3  0.000447708     0.231636
     1            0   N0      1            4   N4  0.000802884     0.598174
     1            0   N0      1            5   N5  0.000299645     0.209596
     1            0   N0      1            6   N6  0.000278992    0.0947867
     1            0   N0      1            7   N7  0.000129386    0.0843693
     1            0   N0      1            8   N8   0.00173647     0.186997
     1            0   N0      1            9   N9   0.00107551     0.409557
     1            0   N0      1           10  N10  0.000148621            1
     1            0   N0      1           11  N11  7.23778e-06    0.0228911
     1            0   N0      1           12  N12  0.000665512     0.141653
     1            0   N0      1           13  N13  0.000636386    0.0492009
     1            0   N0      1           14  N14   0.00101876            1
     1            0   N0      1           15  N15  0.000432297     0.288189
     1            0   N0      1           16  N16   0.00312607     0.284791
     1            0   N0      1           17  N17  0.000770346     0.217123
     1            0   N0      1           18   P1  0.000798405     0.139754
     1            0   N0      1           19   P2   0.00209782     0.891301
     1            1   N1      1            2   N2    0.0017376     0.142034
     1            1   N1      1            3   N3   0.00216632     0.134182
     1            1   N1      1            4   N4   0.00119479     0.192163
     1            1   N1      1            5   N5  0.000290652    0.0355849
     1            1   N1      1            6   N6  0.000894341     0.133186
     1            1   N1      1            7   N7  0.000412185    0.0396561
     1            1   N1      1            8   N8  0.000414408     0.114649
     1            1   N1      1            9   N9  0.000601054    0.0806283
     1            1   N1      1           10  N10  0.000327185    0.0587083
     1            1   N1      1           11  N11  5.02405e-05    0.0158823
     1            1   N1      1           12  N12   0.00138925    0.0538967
     1            1   N1      1           13  N13  0.000324482    0.0350719
     1            1   N1      1           14  N14   0.00265773     0.063909
     1            1   N1      1           15  N15  0.000879857     0.108272
     1            1   N1      1           16  N16  0.000476227    0.0292723
     1            1   N1      1           17  N17   0.00150455     0.079908
     1            1   N1      1           18   P1  0.000457656    0.0278642
     1            1   N1      1           19   P2  0.000359164    0.0971203
     1            2   N2      1            3   N3  2.98863e-05    0.0080687
     1            2   N2      1            4   N4  3.69576e-05    0.0173026
     1            2   N2      1            5   N5  0.000200431    0.0231111
     1            2   N2      1            6   N6   0.00159545    0.0522072
     1            2   N2      1            7   N7  5.82913e-06   0.00421167
     1            2   N2      1            8   N8  0.000172933    0.0379167
     1            2   N2      1            9   N9  0.000130041    0.0118148
     1            2   N2      1           10  N10  0.000399602      0.12673
     1            2   N2      1           11  N11   0.00327338    0.0870017
     1            2   N2      1           12  N12  4.76657e-05   0.00932601
     1            2   N2      1           13  N13  8.11514e-05    0.0342591
     1            2   N2      1           14  N14  1.14382e-05   0.00818936
     1            2   N2      1           15  N15  2.98329e-06   0.00185029
     1            2   N2      1           16  N16  0.000106566    0.0262227
     1            2   N2      1           17  N17   0.00105073    0.0341876
     1            2   N2      1           18   P1  0.000938773    0.0459481
     1            2   N2      1           19   P2   0.00104851    0.0487004
     1            3   N3      1            4   N4  0.000167608    0.0311761
     1            3   N3      1            5   N5  0.000127855    0.0125063
     1            3   N3      1            6   N6  1.75507e-06   0.00204655
     1            3   N3      1            7   N7  2.64163e-05   0.00607465
     1            3   N3      1            8   N8    0.0015051    0.0757893
     1            3   N3      1            9   N9  0.000124643     0.012736
     1            3   N3      1           10  N10   0.00213762     0.432614
     1            3   N3      1           11  N11  7.66189e-05   0.00901841
     1            3   N3      1           12  N12  8.51752e-05       0.0184
     1            3   N3      1           13  N13  0.000781858     0.125683
     1            3   N3      1           14  N14  1.16081e-05    0.0121764
     1            3   N3      1           15  N15  1.75381e-05   0.00530236
     1            3   N3      1           16  N16   0.00136734    0.0794732
     1            3   N3      1           17  N17  7.15784e-06     0.003744
     1            3   N3      1           18   P1  0.000108528    0.0184647
     1            3   N3      1           19   P2   0.00175142    0.0743921
     1            4   N4      1            5   N5  0.000145965    0.0321788
     1            4   N4      1            6   N6   0.00120982     0.129392
     1            4   N4      1            7   N7  1.01445e-05   0.00519665
     1            4   N4      1            8   N8  8.63245e-05    0.0437086
     1            4   N4      1            9   N9   0.00134834     0.100873
     1            4   N4      1           10  N10  4.86309e-05      0.12583
     1            4   N4      1           11  N11  0.000159189    0.0236149
     1            4   N4      1           12  N12   0.00206632     0.174764
     1            4   N4      1           13  N13  0.000156984    0.0292044
     1            4   N4      1           14  N14   0.00104996    0.0480894
     1            4   N4      1           15  N15  2.02081e-06   0.00433426
     1            4   N4      1           16  N16  0.000317612    0.0199683
     1            4   N4      1           17  N17   0.00364646     0.162957
     1            4   N4      1           18   P1  8.39521e-06     0.012367
     1            4   N4      1           19   P2  0.000249608    0.0171392
     1            5   N5      1            6   N6   0.00068467    0.0365464
     1            5   N5      1            7   N7  0.000100069      0.01633
     1            5   N5      1            8   N8  0.000620234    0.0439879
     1            5   N5      1            9   N9   0.00151254    0.0612781
     1            5   N5      1           10  N10  6.98189e-05    0.0864752
     1            5   N5      1           11  N11  4.84599e-06   0.00313261
     1            5   N5      1           12  N12   0.00159792    0.0577013
     1            5   N5      1           13  N13  2.33295e-06    0.0062072
     1            5   N5      1           14  N14  0.000653473    0.0661453
     1            5   N5      1           15  N15   0.00149228    0.0442214
     1            5   N5      1           16  N16    0.0015976     0.062196
     1            5   N5      1           17  N17  0.000751801    0.0277807
     1            5   N5      1           18   P1  0.000258788    0.0393819
     1            5   N5      1           19   P2   0.00611992     0.125729
     1            6   N6      1            7   N7  0.000790317    0.0367443
     1            6   N6      1            8   N8  0.000328831    0.0229318
     1            6   N6      1            9   N9  0.000354788     0.025507
     1            6   N6      1           10  N10  2.34578e-05    0.0700088
     1            6   N6      1           11  N11   0.00091058    0.0452451
     1            6   N6      1           12  N12  0.000128693    0.0117241
     1            6   N6      1           13  N13  0.000171897    0.0381481
     1            6   N6      1           14  N14  2.78651e-05    0.0291436
     1            6   N6      1           15  N15  2.36397e-05   0.00593223
     1            6   N6      1           16  N16  0.000985341    0.0349718
     1            6   N6      1           17  N17  3.40884e-05    0.0126218
     1            6   N6      1           18   P1  0.000179483    0.0458079
     1            6   N6      1           19   P2  0.000647251    0.0872419
     1            7   N7      1            8   N8   0.00269075     0.149565
     1            7   N7      1            9   N9  0.000601996    0.0254204
     1            7   N7      1           10  N10   1.8525e-05    0.0475991
     1            7   N7      1           11  N11   0.00107766    0.0376586
     1            7   N7      1           12  N12  5.01497e-07    0.0016687
     1            7   N7      1           13  N13  1.44337e-05    0.0144483
     1            7   N7      1           14  N14  0.000269272    0.0693137
     1            7   N7      1           15  N15  0.000744286    0.0509818
     1            7   N7      1           16  N16  0.000168939    0.0189269
     1            7   N7      1           17  N17   0.00159406     0.042109
     1            7   N7      1           18   P1  0.000130385    0.0171238
     1            7   N7      1           19   P2  0.000339879    0.0277274
     1            8   N8      1            9   N9   0.00081243    0.0488111
     1            8   N8      1           10  N10  0.000804644       0.1088
     1            8   N8      1           11  N11  6.99992e-06    0.0050166
     1            8   N8      1           12  N12  0.000699341     0.102998
     1            8   N8      1           13  N13  9.11273e-06   0.00694564
     1            8   N8      1           14  N14  0.000746756    0.0400332
     1            8   N8      1           15  N15   4.0685e-05    0.0197016
     1            8   N8      1           16  N16  0.000988257      0.13199
     1            8   N8      1           17  N17   0.00132136    0.0993757
     1            8   N8      1           18   P1  0.000393534    0.0218647
     1            8   N8      1           19   P2  1.09249e-05   0.00363246
     1            9   N9      1           10  N10  0.000209563    0.0950845
     1            9   N9      1           11  N11  4.64625e-05    0.0100045
     1            9   N9      1           12  N12  1.49149e-06    0.0027776
     1            9   N9      1           13  N13   0.00382624     0.243725
     1            9   N9      1           14  N14  0.000205038    0.0583787
     1            9   N9      1           15  N15  0.000178272     0.014819
     1            9   N9      1           16  N16  5.59517e-05    0.0183395
     1            9   N9      1           17  N17  0.000387392    0.0314209
     1            9   N9      1           18   P1  0.000154354    0.0193033
     1            9   N9      1           19   P2  0.000134158    0.0180485
     1           10  N10      1           11  N11    0.0002223     0.143736
     1           10  N10      1           12  N12  8.63261e-05    0.0436059
     1           10  N10      1           13  N13  0.000528059    0.0383072
     1           10  N10      1           14  N14  0.000980866    0.0819977
     1           10  N10      1           15  N15  3.64147e-05    0.0714909
     1           10  N10      1           16  N16  2.56131e-05    0.0220335
     1           10  N10      1           17  N17    0.0023212     0.505188
     1           10  N10      1           18   P1   0.00101458     0.134655
     1           10  N10      1           19   P2  1.26688e-06    0.0187212
     1           11  N11      1           12  N12  0.000161567    0.0196966
     1           11  N11      1           13  N13  6.87411e-05    0.0479475
     1           11  N11      1           14  N14  0.000872452      0.10876
     1           11  N11      1           15  N15    0.0019084    0.0536846
     1           11  N11      1           16  N16  0.000765209    0.0612539
     1           11  N11      1           17  N17   0.00196082    0.0638448
     1           11  N11      1           18   P1  6.08111e-05    0.0177831
     1           11  N11      1           19   P2  0.000263488    0.0371242
     1           12  N12      1           13  N13  0.000295513      0.15405
     1           12  N12      1           14  N14  0.000249644    0.0901521
     1           12  N12      1           15  N15  0.000399751    0.0252113
     1           12  N12      1           16  N16  0.000508144    0.0243005
     1           12  N12      1           17  N17  0.000632754    0.0562004
     1           12  N12      1           18   P1  0.000139554    0.0417448
     1           12  N12      1           19   P2  1.12005e-05   0.00372626
     1           13  N13      1           14  N14  0.000784602    0.0439929
     1           13  N13      1           15  N15  0.000106354    0.0732908
     1           13  N13      1           16  N16   0.00103394    0.0839774
     1           13  N13      1           17  N17   9.0432e-05    0.0598162
     1           13  N13      1           18   P1  0.000920573    0.0769432
     1           13  N13      1           19   P2  0.000705199    0.0671486
     1           14  N14      1           15  N15  7.45231e-06   0.00617055
     1           14  N14      1           16  N16   0.00109154     0.203216
     1           14  N14      1           17  N17   0.00135083    0.0938628
     1           14  N14      1           18   P1  0.000924271    0.0490889
     1           14  N14      1           19   P2  6.67493e-05    0.0131537
     1           15  N15      1           16  N16  0.000105878     0.013987
     1           15  N15      1           17  N17  2.28392e-06    0.0026777
     1           15  N15      1           18   P1   0.00209955    0.0641442
     1           15  N15      1           19   P2  0.000152973    0.0173645
     1           16  N16      1           17  N17   0.00168437    0.0630312
     1           16  N16      1           18   P1  0.000671612    0.0987218
     1           16  N16      1           19   P2   0.00195047    0.0456145
     1           17  N17      1           18   P1  1.07015e-05   0.00811408
     1           17  N17      1           19   P2   0.00103718    0.0801131
     1           18   P1      1           19   P2    0.0279074      0.16754
```

```
$ plink --bfile mydata --ld P1 P2 --allow-no-sex

   R-sq = 0.0279074      D' = 0.16754

   Haplotype     Frequency    Expectation under LE
   ---------     ---------    --------------------
          aa      0.068063                0.041069
          Aa      0.134124                0.161118
          aA      0.135062                0.162056
          AA      0.662751                0.635757

   In phase alleles are aa/AA
```
```
P1    : [0.640625 0.3125   0.046875]
P2    : [0.633125 0.329375 0.0375  ]

[ P ]
[[726. 256.  43.]
 [238. 245.  17.]
 [ 49.  26.   0.]]

[ P ]
[[0.45375  0.16     0.026875]
 [0.14875  0.153125 0.010625]
 [0.030625 0.01625  0.      ]]

[ Psi ]
[[0.4055957  0.21100586 0.02402344]
 [0.19785156 0.10292969 0.01171875]
 [0.02967773 0.01543945 0.00175781]]

[ Omega ]
[[ 0.0481543  -0.05100586  0.00285156]
 [-0.04910156  0.05019531 -0.00109375]
 [ 0.00094727  0.00081055 -0.00175781]]
 
D = 0.010649414062499942
```
```
N5      : [589. 756. 255.]
P2      : [1013.  527.   60.]

N5      : [0.368125 0.4725   0.159375]
P2      : [0.633125 0.329375 0.0375  ]

[ P ]
[[399. 170.  20.]
 [472. 255.  29.]
 [142. 102.  11.]]

[ P ]
[[0.249375 0.10625  0.0125  ]
 [0.295    0.159375 0.018125]
 [0.08875  0.06375  0.006875]]

[ Psi ]
[[0.23306914 0.12125117 0.01380469]
 [0.29915156 0.15562969 0.01771875]
 [0.1009043  0.05249414 0.00597656]]

[ Omega ]
[[ 0.01630586 -0.01500117 -0.00130469]
 [-0.00415156  0.00374531  0.00040625]
 [-0.0121543   0.01125586  0.00089844]]

D = 0.007665820312500002
```
```
N4      : [1069.  495.   36.]
P1      : [1025.  500.   75.]

N4      : [0.668125 0.309375 0.0225  ]
P1      : [0.640625 0.3125   0.046875]

[ P ]
[[686. 329.  54.]
 [317. 159.  19.]
 [ 22.  12.   2.]]

[ P ]
[[0.42875  0.205625 0.03375 ]
 [0.198125 0.099375 0.011875]
 [0.01375  0.0075   0.00125 ]]

[ Psi ]
[[0.42801758 0.20878906 0.03131836]
 [0.19819336 0.09667969 0.01450195]
 [0.01441406 0.00703125 0.00105469]]

[ Omega ]
[[ 7.32421875e-04 -3.16406250e-03  2.43164063e-03]
 [-6.83593750e-05  2.69531250e-03 -2.62695313e-03]
 [-6.64062500e-04  4.68750000e-04  1.95312500e-04]]

D = -0.00020996093749994435
```
```
N12     : [929. 577.  94.]
P2      : [1013.  527.   60.]

N12     : [0.580625 0.360625 0.05875 ]
P2      : [0.633125 0.329375 0.0375  ]

[ P ]
[[597. 295.  37.]
 [351. 207.  19.]
 [ 65.  25.   4.]]

[ P ]
[[0.373125 0.184375 0.023125]
 [0.219375 0.129375 0.011875]
 [0.040625 0.015625 0.0025  ]]

[ Psi ]
[[0.3676082  0.19124336 0.02177344]
 [0.2283207  0.11878086 0.01352344]
 [0.03719609 0.01935078 0.00220312]]

[ Omega ]
[[ 0.0055168  -0.00686836  0.00135156]
 [-0.0089457   0.01059414 -0.00164844]
 [ 0.00342891 -0.00372578  0.00029688]]

D = 0.0002583007812500225
```
There are other options.
```
$ plink --bfile mydata --ld rs2840528 rs7545940  # LD between rs2840528 and rx7545940
$ plink --bfile mydata --r2 --ld-window 10 --ld-window-kb 1000 --ld-window-r2 0.2 # these are default values
```

# Epistasis

<http://zzz.bwh.harvard.edu/plink/epi.shtml>

```
$ plink --bfile mydata --epistasis --allow-no-sex
$ less plink.epi.cc

CHR1 SNP1 CHR2 SNP2       OR_INT         STAT            P
   1   P1    1   P2    0.0576579      184.702    4.745e-42
   
$ less plink.epi.cc.summary

 CHR  SNP        N_SIG        N_TOT         PROP   BEST_CHISQ BEST_CHR BEST_SNP
   1   N0            0           18            0        3.289    1   N9
   1   N1            0           19            0        3.486    1  N12
   1   N2            0           19            0        3.511    1  N11
   1   N3            1           19      0.05263        8.947    1   N7
   1   N4            0           19            0        2.694    1  N12
   1   N5            1           19      0.05263        7.606    1  N11
   1   N6            0           19            0        3.183    1   N0
   1   N7            1           19      0.05263        8.947    1   N3
   1   N8            1           19      0.05263        11.93    1  N14
   1   N9            0           19            0        3.289    1   N0
   1  N10            0           18            0        2.215    1   N7
   1  N11            1           19      0.05263        7.606    1   N5
   1  N12            0           19            0        3.486    1   N1
   1  N13            0           19            0        1.812    1   P1
   1  N14            1           19      0.05263        11.93    1   N8
   1  N15            0           19            0        3.274    1   N0
   1  N16            0           19            0        3.507    1   P1
   1  N17            0           19            0        2.206    1   N7
   1   P1            1           19      0.05263        184.7    1   P2
   1   P2            1           19      0.05263        184.7    1   P1
```

# Networks

![NETWORKS](./image/network.png)

# Ternary Plot

![Ternary_Plot](./image/ternary.png)

# Combinations

![combo_result](./image/combinations.png)
